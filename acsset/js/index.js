var products = [
    // bestseller
    {
        id:1,
        img: "./acsset/img/product-item-1.jpg",
        name: "Blanche Parfum",
        current_price: 45,
        old_price: 65,
        cate: "bestseller"
    },
    {
        id:2,
        img: "./acsset/img/product-item-2.jpg",
        name: "Tuscan Creations",
        current_price: 45,
        old_price: 65,
        cate: "bestseller"
    },
    {
        id:3,
        img: "./acsset/img/product-item-3.jpg",
        name: "Terra Rossa",
        current_price: 45,
        old_price: 65,
        cate: "bestseller"
    },
    {
        id:4,
        img: "./acsset/img/product-item-4.jpg",
        name: "Glorious Eau",
        current_price: 45,
        old_price: 65,
        cate: "bestseller"
    },
    {
        id:5,
        img: "./acsset/img/product-item-5.jpg",
        name: "The Alchemist",
        current_price: 45,
        old_price: 65,
        cate: "bestseller"
    },
    {
        id:6,
        img: "./acsset/img/product-item-6.jpg",
        name: "Garden A Winter",
        current_price: 45,
        old_price: 65,
        cate: "bestseller"
    },
    {
        id:7,
        img: "./acsset/img/product-item-7.jpg",
        name: "Melody Eau",
        current_price: 45,
        old_price: 65,
        cate: "bestseller"
    },
    {
        id:8,
        img: "./acsset/img/product-item-8.jpg",
        name: "Toilette",
        current_price: 45,
        old_price: 65,
        cate: "bestseller"
    },
    // new arrivals
    {
        id:9,
        img: "./acsset/img/product-item-9.jpg",
        name: "Ambre Royal",
        current_price: 45,
        old_price: 65,
        cate: "new arrivals"
    },
    {
        id:10,
        img: "./acsset/img/product-item-10.jpg",
        name: "Patiala Eau",
        current_price: 45,
        old_price: 65,
        cate: "new arrivals"
    },
    {
        id:11,
        img: "./acsset/img/product-item-11.jpg",
        name: "Mojave Ghost",
        current_price: 45,
        old_price: 65,
        cate: "new arrivals"
    },
    {
        id:12,
        img: "./acsset/img/product-item-13.jpg",
        name: "Rose Elixir",
        current_price: 45,
        old_price: 65,
        cate: "new arrivals"
    },
    {
        id:13,
        img: "./acsset/img/product-item-14.jpg",
        name: "Aoud Queen Roses",
        current_price: 45,
        old_price: 65,
        cate: "new arrivals"
    },
    {
        id:14,
        img: "./acsset/img/product-item-15.jpg",
        name: "Love Eau",
        current_price: 45,
        old_price: 65,
        cate: "new arrivals"
    },
    {
        id:15,
        img: "./acsset/img/product-item-16.jpg",
        name: "Bibliotheque",
        current_price: 45,
        old_price: 65,
        cate: "new arrivals"
    },
    {
        id:16,
        img: "./acsset/img/product-item-2.jpg",
        name: "Tuscan Creations",
        current_price: 45,
        old_price: 65,
        cate: "new arrivals"
    },
    // top rated
    {
        id:17,
        img: "./acsset/img/product-item-10.jpg",
        name: "Patiala Eau",
        current_price: 45,
        old_price: 65,
        cate: "top rated"
    },
    {
        id:18,
        img: "./acsset/img/product-item-12.jpg",
        name: "Bal Afrique",
        current_price: 45,
        old_price: 65,
        cate: "top rated"
    },
    {
        id:19,
        img: "./acsset/img/product-item-8.jpg",
        name: "Exotic Diamond",
        current_price: 45,
        old_price: 65,
        cate: "top rated"
    },
    {
        id:20,
        img: "./acsset/img/product-item-4.jpg",
        name: "Mon Guerlain",
        current_price: 45,
        old_price: 65,
        cate: "top rated"
    },
    {
        id:21,
        img: "./acsset/img/product-item-9.jpg",
        name: "Dainty Diamond",
        current_price: 45,
        old_price: 65,
        cate: "top rated"
    },
    {
        id:22,
        img: "./acsset/img/product-item-13.jpg",
        name: "Magnificent Bangle",
        current_price: 45,
        old_price: 65,
        cate: "top rated"
    },
    {
        id:23,
        img: "./acsset/img/product-item-16.jpg",
        name: "Florale",
        current_price: 45,
        old_price: 65,
        cate: "top rated"
    },
    {
        id:24,
        img: "./acsset/img/product-item-8.jpg",
        name: "The Alchemist",
        current_price: 45,
        old_price: 65,
        cate: "top rated"
    },
    {
        id:25,
        img: "./acsset/img/product-item-17.jpg",
        name: "Glorious Eau",
        current_price: 45,
        old_price: 65,
        cate: "",
        deal: true
    },
    {
        id:26,
        img: "./acsset/img/product-item-21.jpg",
        name: "The Alchemist",
        current_price: 45,
        old_price: 65,
        cate: "",
        deal: true
    },
    {
        id:27,
        img: "./acsset/img/product-item-22.jpg",
        name: "The Alchemist",
        current_price: 45,
        old_price: 65,
        cate: "",
        deal: true
    },
    {
        id:28,
        img: "./acsset/img/product-item-19.jpg",
        name: "The Alchemist",
        current_price: 45,
        old_price: 65,
        cate: "",
        deal: true
    },
    {
        id:29,
        img: "./acsset/img/product-item-18.jpg",
        name: "The Alchemist",
        current_price: 45,
        old_price: 65,
        cate: "",
        deal: true
    },
    {
        id:30,
        img: "./acsset/img/product-item-20.jpg",
        name: "The Alchemist",
        current_price: 45,
        old_price: 65,
        cate: "",
        deal: true
    },
]

var posts = [
    {
        id: 1,
        src: './acsset/img/slider-blog-thumb-1.jpg',
        title: "We bring you the best",
        desc: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Placeat reiciendis culpa impedit eius?",
        cate: "clothing"
    },
    {
        id: 2,
        src: './acsset/img/slider-blog-thumb-2.jpg',
        title: "We know that buying Items",
        desc: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Placeat reiciendis culpa impedit eius?",
        cate: "clothing"
    },
    {
        id: 3,
        src: './acsset/img/slider-blog-thumb-3.jpg',
        title: "We design functional Items",
        desc: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Placeat reiciendis culpa impedit eius?",
        cate: "clothing"
    },
    {
        id: 4,
        src: './acsset/img/slider-blog-thumb-4.jpg',
        title: "How to Build Your Perfect Dining",
        desc: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Placeat reiciendis culpa impedit eius?",
        cate: "clothing"
    },
    {
        id: 5,
        src: './acsset/img/blog-item-list-5.jpg',
        title: "New Designer Outdoor Items",
        desc: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Placeat reiciendis culpa impedit eius?",
        cate: "clothing"
    },
]

localStorage.setItem('posts', JSON.stringify(posts));
localStorage.setItem('products', JSON.stringify(products))

const container = document.querySelector('.js-container-product');
const categories = document.querySelectorAll('.js-cate');
const cateContent = document.querySelector('.js-cate-content');
const cateItems = document.querySelectorAll('.js-cate-items');
const dealContainer = document.querySelector('.deal__container');
const modal = document.querySelector('.modal');

for(const cateItem of cateItems) {
    cateItem.addEventListener('click',()=>{
        cateContent.innerHTML = cateItem.textContent;
    })
}

function renderDeal() {
    const html = products.map((value, index) => {
        if(value.deal == true) {
            return `
                <li class="deal__items">
                    <div class="product">
                        <span class="product__label">New</span>
                        <div class="product__img-link">
                            <a href="product.html" onclick="postProduct(${value.id})" class="product__img">
                                <img src="${value.img}" alt="">
                            </a>
                            <div class="product__action hidden-mobile">
                                <a href="#"><i class="fa-regular fa-heart"></i></a>
                                <span onclick="renderModal(${value.id})"><i class="fa-solid fa-magnifying-glass"></i></span>
                                <span onclick="addCart(${value.id}, 1)"><i class="fa-solid fa-bag-shopping"></i></span>
                            </div>
                        </div>
                        <div class="product__content">
                            <div class="product__time">
                                <div class="product__time-items">
                                    <span>00</span>
                                    <span>days</span>
                                </div>
                                <div class="product__time-items">
                                    <span>00</span>
                                    <span>days</span>
                                </div>
                                <div class="product__time-items">
                                    <span>00</span>
                                    <span>days</span>
                                </div>
                                <div class="product__time-items">
                                    <span>00</span>
                                    <span>days</span>
                                </div>
                            </div>
                            <h3 class="product__name">${value.name}</h3>
                            <div class="product__rating">
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-regular fa-star"></i>
                                <i class="fa-regular fa-star"></i>
                            </div>
                            <p class="product__price">
                                <span class="product__price--old">$${value.old_price}</span>
                                <span class="product__price--new">$${value.current_price}</span>
                            </p>
                        </div>
                    </div>
                </li>
                `
        }
    })
    dealContainer.innerHTML = html.join('');
}

renderDeal()

function render(arr) {
    const html = arr.map((value, index) => {
        return `
        <div class="col c-6 m-6 l-3">
            <div class="product">
                <span class="product__label">New</span>
                <div class="product__img-link">
                    <a href="product.html" onclick="postProduct(${value.id})" class="product__img">
                        <img src="${value.img}" alt="">
                    </a>
                    <div class="product__action hidden-mobile">
                        <a href="#"><i class="fa-regular fa-heart"></i></a>
                        <span onclick="renderModal(${value.id})"><i class="fa-solid fa-magnifying-glass"></i></span>
                        <span onclick="addCart(${value.id}, 1)"><i class="fa-solid fa-bag-shopping"></i></span>
                    </div>
                </div>
                <div class="product__content">
                    <h3 class="product__name">${value.name}</h3>
                    <div class="product__rating">
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-regular fa-star"></i>
                        <i class="fa-regular fa-star"></i>
                    </div>
                    <p class="product__price">
                        <span class="product__price--old">$${value.old_price}</span>
                        <span class="product__price--new">$${value.current_price}</span>
                    </p>
                </div>
            </div>
        </div>
        `
    })
    container.innerHTML = html.join("");
}

for(const category of categories) {
    category.addEventListener('click', ()=> {
        for(var i = 0; i < categories.length; i++){
            if(category == categories[i]) {
                categories[i].classList.add('active');
            }else {
                categories[i].classList.remove('active');
            }
        }
        var cate = category.innerHTML;
        let list = products.filter(value => {
            return value.cate.toLowerCase().includes(cate.toLowerCase());
        })
        render(list);
    })
}

categories[0].click();  
var carts = storedCart ?? [];   

$('.deal__container').slick({
    dots: true,
    infinite: false,
    speed: 1200,
    slidesToShow: 4,
    slidesToScroll: 1,
    responsive: [
        {
        breakpoint: 1024,
        settings: {
            slidesToShow: 2,
            slidesToScroll: 1,
            infinite: true,
            dots: true
        }
        },
        {
        breakpoint: 600,
        settings: {
            slidesToShow: 2,
            slidesToScroll: 1
        }
        },
        {
        breakpoint: 480,
        settings: {
            slidesToShow: 1,
            slidesToScroll: 1
        }
        }
    ]
    });

var isRenderModal = false

function renderModal(index) {
    let i = index;
    isRenderModal = true;
    let id = products.findIndex((value) => {
        return value.id == index;
    });
    const html = `
    <div class="modal__container">
        <div class="detail__product">
            <div class="gird">
                <div class="row">
                    <div class="col c-12 m-6 l-6">
                        <div class="detail__product--img">
                            <img class="js-img" src="${products[id].img}" alt="">
                            <div class="detail__slider">
                                <div class="slider__img--container">
                                    <ul class="img__slider">
                                        <li class="img__slider--items active">
                                            <img src="${products[id].img}" alt="">
                                        </li>
                                        <li class="img__slider--items">
                                            <img src="${products[id].img}" alt="">
                                        </li>
                                        <li class="img__slider--items">
                                            <img src="${products[id].img}" alt="">
                                        </li>
                                        <li class="img__slider--items">
                                            <img src="${products[id].img}" alt="">
                                        </li>
                                        <li class="img__slider--items">
                                            <img src="${products[id].img}" alt="">
                                        </li>
                                    </ul>
                                </div>
                                <div class="prev-img control-slider-img">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </div>
                                <div class="next-img control-slider-img">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col c-12 m-6 l-6">
                        <div class="detail__product--container">
                            <div class="detail__product--info">
                                <h3 class="name">${products[id].name}</h3>
                                <div class="product__rating">
                                    <i class="fa-solid fa-star"></i>
                                    <i class="fa-solid fa-star"></i>
                                    <i class="fa-solid fa-star"></i>
                                    <i class="fa-regular fa-star"></i>
                                    <i class="fa-regular fa-star"></i>
                                </div>
                                <div class="p status">
                                    <span>Availability: </span>
                                    <a href="">In Stock</a>
                                </div>
                                <p class="price">€${products[id].current_price}</p>
                            </div>
                            <ul class="detail__product--desc">
                                <li>Vestibulum tortor quam</li>
                                <li>Imported</li>
                                <li>Art.No. 06-7680</li>
                            </ul>
                            <div class="detail__product--option">
                                <p>
                                    <span  class="title">Color:</span>
                                    <span>White/Black/Teal/Brown</span>
                                </p>
                                <ul class="sidebar__list">
                                    <li class="sidebar__items">
                                        <a class="bg-white border-default">
                                            <i class="fa-solid fa-check"></i>
                                        </a>
                                    </li>
                                    <li class="sidebar__items">
                                        <a class="bg-black">
                                            <i class="fa-solid fa-check"></i>
                                        </a>
                                    </li>
                                    <li class="sidebar__items">
                                        <a class="bg-color_1">
                                            <i class="fa-solid fa-check"></i>
                                        </a>
                                    </li>
                                    <li class="sidebar__items active">
                                        <a class="bg-color_2 ">
                                            <i class="fa-solid fa-check"></i>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="detail__product--option">
                                <p>
                                    <span  class="title">Pots Size:</span>
                                </p>
                                <ul class="sidebar__list">
                                    <li class="sidebar__items">
                                        <a class="size border-default">
                                            XS
                                        </a>
                                    </li>
                                    <li class="sidebar__items">
                                        <a class="size border-default">
                                            S
                                        </a>
                                    </li>
                                    <li class="sidebar__items">
                                        <a class="size border-default">
                                            M
                                        </a>
                                    </li>
                                    <li class="sidebar__items active-size">
                                        <a class="size border-default">
                                            L
                                        </a>
                                    </li>
                                    <li class="sidebar__items">
                                        <a class="size border-default">
                                            XL
                                        </a>
                                    </li>
                                    <li class="sidebar__items">
                                        <a class="size border-default">
                                            XXL
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="detail__product--action">
                                <a href="#" class="add-to-wishlist mg-r-20">
                                    <i class="fa-regular fa-heart no-full"></i>
                                    <i class="fa-solid fa-heart full"></i>
                                    <span>Add to Wishlist</span>
                                </a>
                                <a href="#" class="view-size-chart">
                                    <i class="fa-solid fa-ruler-horizontal"></i>
                                    <span>View Size Chart</span>
                                </a>
                            </div>
                            <div class="group--btn">
                                <div class="detail__quantify--control mg-r-10 border-default ">
                                    <button onclick="reduce(document.querySelector('.q'))" class="detail__quantify--control-action"><i class="fa-solid fa-minus"></i></button>
                                    <span class="q">1</span>
                                    <button onclick="increase(document.querySelector('.q'))" class="detail__quantify--control-action"><i class="fa-solid fa-plus"></i></button>
                                </div>
                                <a class="btn--primary" onclick="addCart(${i}, parseInt(document.querySelector('.q').innerText))" href="#">add to cart</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button class="close" onclick="closeModal()">
            <i class="fa-solid fa-xmark"></i>
        </button>       
    </div>
    `
    modal.classList.remove('hidden_modal');
    modal.innerHTML = html;
    slider()
}

function closeModal() {
    modal.classList.add('hidden_modal');
}

const listPosts = document.querySelector('.news__list');
function renderPosts() {
    const html = posts.map(value => {
        return `
        <li class="news__items">
            <div class="news-posts__container">
                <div class="news-posts__img">
                    <img src="${value.src}" alt="">
                </div>
                <div class="news-posts__content">
                    <p class="news-posts__content--time">
                        <span>august 17</span>,
                        <span>09:14 AM</span>
                    </p>
                    <a href="posts.html" onclick = "post(${value.id})" class="news-posts__content--title">${value.title}</a>
                    <p class="news-posts__content--desc">${value.desc}</p>
                    <a href="" class="banner--link">
                        read more
                        <span></span>
                    </a>
                </div>
            </div>
        </li> 
        `
    })
    listPosts.innerHTML = html.join('');
}

renderPosts();
$('.news__list').slick({
    dots: true,
    infinite: false,
    speed: 1200,
    slidesToShow: 3,
    slidesToScroll: 1,
    responsive: [
        {
        breakpoint: 1024,
        settings: {
            slidesToShow: 2,
            slidesToScroll: 1,
            infinite: true,
            dots: true
        }
        },
        {
        breakpoint: 600,
        settings: {
            slidesToShow: 1,
            slidesToScroll: 1
        }
        },
        {
        breakpoint: 480,
        settings: {
            slidesToShow: 1,
            slidesToScroll: 1
        }
        }
    ]
})

function post(i) {
    id = posts.findIndex(value =>{
        return value.id == i;
    })
    localStorage.setItem('postItem', JSON.stringify(posts[id]));
}

function slider() {
    const btnPrevSlider = document.querySelector('.prev-img');
    const btnNextSlider = document.querySelector('.next-img');
    const sliderItems = document.querySelectorAll('.img__slider--items');
    const sliderContainer = document.querySelector('.img__slider');
    const img = document.querySelector('.js-img');

    let maxPart = sliderItems.length - 2;
    let part = 0;
    var index = 0;

    let style = window.getComputedStyle(sliderItems[1]);
    let widthWithMargin = parseInt(style.getPropertyValue("width")) + parseInt(style.getPropertyValue("margin-left")) + parseInt(style.getPropertyValue("margin-right"));
    
    function updateItems(index, part) {
        sliderItems.forEach((sliderItem) => {
            sliderItem.classList.remove('active');
        });
        sliderItems[index].classList.add('active');
        img.src = sliderItems[index].querySelector('img').src;
        img.style.animation = 'bright ease-in-out .5s'
        sliderContainer.style.transform = `translateX(-${widthWithMargin * part}px)`
    }
    
    
    btnPrevSlider.addEventListener('click', ()=> {
        img.style.animation = ""
        if(index > 0) {
            index--;
        }
        if(part > 0) {
            part--;
        }
        setTimeout(()=> {
            updateItems(index, part);
        },10)
    })

    btnNextSlider.addEventListener('click', ()=> {
        img.style.animation = ""
        if(index < sliderItems.length - 1) {
            index ++;
        }
        if(part < maxPart-1) {
            part++;
        }
        setTimeout(()=> {
            updateItems(index, part);
        },10)
    })
    
    sliderItems.forEach( sliderItem=> {
        sliderItem.onclick = ()=> {
            img.style.animation = ""
            for(var i = 0; i < sliderItems.length; i++) {
                if(sliderItem == sliderItems[i]) index = i;
            }
            setTimeout(()=> {
                updateItems(index, part);
            },10)
        }
    })
}




